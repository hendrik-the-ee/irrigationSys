"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.EMPTY_SLICE = exports.ListSlice = exports.LinkedList = exports.ListNode = void 0;

var _lifetimes = require("./lifetimes");

function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}

function _createClass(Constructor, protoProps, staticProps) {
  if (protoProps) _defineProperties(Constructor.prototype, protoProps);
  if (staticProps) _defineProperties(Constructor, staticProps);
  return Constructor;
}

var ListNode = function ListNode(value) {
  this.next = null;
  this.prev = null;
  this.value = value;
};

exports.ListNode = ListNode;

var LinkedList =
/*#__PURE__*/
function () {
  function LinkedList() {
    this.clear();
  }

  var _proto = LinkedList.prototype;

  _proto.head = function head() {
    return this._head;
  };

  _proto.tail = function tail() {
    return this._tail;
  };

  _proto.clear = function clear() {
    this._head = this._tail = null;
  };

  _proto.toArray = function toArray() {
    var out = [];
    this.forEachNode(function (n) {
      return out.push(n);
    });
    return out;
  };

  _proto.nextNode = function nextNode(node) {
    return node.next;
  };

  _proto.forEachNode = function forEachNode(callback) {
    var node = this._head;

    while (node !== null) {
      callback(node);
      node = node.next;
    }
  };

  _proto.insertBefore = function insertBefore(node, reference) {
    if (reference === void 0) {
      reference = null;
    }

    if (reference === null) return this.append(node);
    if (reference.prev) reference.prev.next = node;else this._head = node;
    node.prev = reference.prev;
    node.next = reference;
    reference.prev = node;
    return node;
  };

  _proto.append = function append(node) {
    var tail = this._tail;

    if (tail) {
      tail.next = node;
      node.prev = tail;
      node.next = null;
    } else {
      this._head = node;
    }

    return this._tail = node;
  };

  _proto.remove = function remove(node) {
    if (node.prev) node.prev.next = node.next;else this._head = node.next;
    if (node.next) node.next.prev = node.prev;else this._tail = node.prev;
    return node;
  };

  _proto[_lifetimes.WILL_DROP] = function () {
    this.forEachNode(function (d) {
      return (0, _lifetimes.destructor)(d)[_lifetimes.WILL_DROP]();
    });
  };

  _proto[_lifetimes.DID_DROP] = function () {
    this.forEachNode(function (d) {
      return (0, _lifetimes.destructor)(d)[_lifetimes.DID_DROP]();
    });
  };

  _createClass(LinkedList, [{
    key: _lifetimes.CHILDREN,
    get: function get() {
      var out = [];
      this.forEachNode(function (d) {
        return out.push.apply(out, (0, _lifetimes.destructor)(d)[_lifetimes.CHILDREN]);
      });
      return out;
    }
  }]);

  return LinkedList;
}();

exports.LinkedList = LinkedList;

var ListSlice =
/*#__PURE__*/
function () {
  function ListSlice(head, tail) {
    this._head = head;
    this._tail = tail;
  }

  var _proto2 = ListSlice.prototype;

  _proto2.forEachNode = function forEachNode(callback) {
    var node = this._head;

    while (node !== null) {
      callback(node);
      node = this.nextNode(node);
    }
  };

  _proto2.head = function head() {
    return this._head;
  };

  _proto2.tail = function tail() {
    return this._tail;
  };

  _proto2.toArray = function toArray() {
    var out = [];
    this.forEachNode(function (n) {
      return out.push(n);
    });
    return out;
  };

  _proto2.nextNode = function nextNode(node) {
    if (node === this._tail) return null;
    return node.next;
  };

  return ListSlice;
}();

exports.ListSlice = ListSlice;
var EMPTY_SLICE = new ListSlice(null, null);
exports.EMPTY_SLICE = EMPTY_SLICE;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3V0aWwvbGliL2xpc3QtdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFRQSxJQUFNLFFBQU4sR0FLRSxTQUFBLFFBQUEsQ0FBQSxLQUFBLEVBQW9CO0FBSmIsT0FBQSxJQUFBLEdBQUEsSUFBQTtBQUNBLE9BQUEsSUFBQSxHQUFBLElBQUE7QUFJTCxPQUFBLEtBQUEsR0FBQSxLQUFBO0FBTkosQ0FBQTs7OztBQWNBLElBQU0sVUFBTjtBQUFBO0FBQUEsWUFBQTtBQUlFLFdBQUEsVUFBQSxHQUFBO0FBQ0UsU0FBQSxLQUFBO0FBQ0Q7O0FBTkgsTUFBQSxNQUFBLEdBQUEsVUFBQSxDQUFBLFNBQUE7O0FBQUEsRUFBQSxNQUFBLENBQUEsSUFBQSxHQVFFLFNBQUEsSUFBQSxHQUFJO0FBQ0YsV0FBTyxLQUFQLEtBQUE7QUFUSixHQUFBOztBQUFBLEVBQUEsTUFBQSxDQUFBLElBQUEsR0FZRSxTQUFBLElBQUEsR0FBSTtBQUNGLFdBQU8sS0FBUCxLQUFBO0FBYkosR0FBQTs7QUFBQSxFQUFBLE1BQUEsQ0FBQSxLQUFBLEdBZ0JFLFNBQUEsS0FBQSxHQUFLO0FBQ0gsU0FBQSxLQUFBLEdBQWEsS0FBQSxLQUFBLEdBQWIsSUFBQTtBQWpCSixHQUFBOztBQUFBLEVBQUEsTUFBQSxDQUFBLE9BQUEsR0FvQkUsU0FBQSxPQUFBLEdBQU87QUFDTCxRQUFJLEdBQUcsR0FBUCxFQUFBO0FBQ0EsU0FBQSxXQUFBLENBQWlCLFVBQUEsQ0FBQSxFQUFDO0FBQUEsYUFBSSxHQUFHLENBQUgsSUFBQSxDQUF0QixDQUFzQixDQUFKO0FBQWxCLEtBQUE7QUFDQSxXQUFBLEdBQUE7QUF2QkosR0FBQTs7QUFBQSxFQUFBLE1BQUEsQ0FBQSxRQUFBLEdBMEJFLFNBQUEsUUFBQSxDQUFBLElBQUEsRUFBZ0I7QUFDZCxXQUFPLElBQUksQ0FBWCxJQUFBO0FBM0JKLEdB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O0FBQ3pCLFdBQU8sSUFBSSxDQUFYLElBQUE7QUFsQ0osR0FBQTs7QUFBQSxTQUFBLFNBQUE7QUFBQSxDQUFBLEVBQUE7OztBQXNDTyxJQUFNLFdBQVcsR0FBRyxJQUFBLFNBQUEsQ0FBQSxJQUFBLEVBQXBCLElBQW9CLENBQXBCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT3B0aW9uIH0gZnJvbSAnLi9wbGF0Zm9ybS11dGlscyc7XG5pbXBvcnQgeyBXSUxMX0RST1AsIERJRF9EUk9QLCBkZXN0cnVjdG9yLCBDSElMRFJFTiB9IGZyb20gJy4vbGlmZXRpbWVzJztcbmltcG9ydCB7IERyb3AgfSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcblxuZXhwb3J0IGludGVyZmFjZSBMaW5rZWRMaXN0Tm9kZSB7XG4gIG5leHQ6IE9wdGlvbjxMaW5rZWRMaXN0Tm9kZT47XG4gIHByZXY6IE9wdGlvbjxMaW5rZWRMaXN0Tm9kZT47XG59XG5cbmV4cG9ydCBjbGFzcyBMaXN0Tm9kZTxUPiBpbXBsZW1lbnRzIExpbmtlZExpc3ROb2RlIHtcbiAgcHVibGljIG5leHQ6IE9wdGlvbjxMaXN0Tm9kZTxUPj4gPSBudWxsO1xuICBwdWJsaWMgcHJldjogT3B0aW9uPExpc3ROb2RlPFQ+PiA9IG51bGw7XG4gIHB1YmxpYyB2YWx1ZTogVDtcblxuICBjb25zdHJ1Y3Rvcih2YWx1ZTogVCkge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxufVxuXG4vLyB3ZSBhcmUgdW5hYmxlIHRvIGV4cHJlc3MgdGhlIGNvbnN0cmFpbnQgdGhhdCBUJ3MgLnByZXYgYW5kIC5uZXh0IGFyZVxuLy8gdGhlbXNlbHZlcyBULiBIb3dldmVyLCBpdCB3aWxsIGFsd2F5cyBiZSB0cnVlLCBzbyB0cnVzdCB1cy5cbnR5cGUgdHJ1c3QgPSBhbnk7XG5cbmV4cG9ydCBjbGFzcyBMaW5rZWRMaXN0PFQgZXh0ZW5kcyBMaW5rZWRMaXN0Tm9kZT4gaW1wbGVtZW50cyBTbGljZTxUPiwgRHJvcCB7XG4gIHByaXZhdGUgX2hlYWQhOiBPcHRpb248VD47XG4gIHByaXZhdGUgX3RhaWwhOiBPcHRpb248VD47XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5jbGVhcigpO1xuICB9XG5cbiAgaGVhZCgpOiBPcHRpb248VD4ge1xuICAgIHJldHVybiB0aGlzLl9oZWFkO1xuICB9XG5cbiAgdGFpbCgpOiBPcHRpb248VD4ge1xuICAgIHJldHVybiB0aGlzLl90YWlsO1xuICB9XG5cbiAgY2xlYXIoKSB7XG4gICAgdGhpcy5faGVhZCA9IHRoaXMuX3RhaWwgPSBudWxsO1xuICB9XG5cbiAgdG9BcnJheSgpOiBUW10ge1xuICAgIGxldCBvdXQ6IFRbXSA9IFtdO1xuICAgIHRoaXMuZm9yRWFjaE5vZGUobiA9PiBvdXQucHVzaChuKSk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuXG4gIG5leHROb2RlKG5vZGU6IFQpOiBUIHtcbiAgICByZXR1cm4gbm9kZS5uZXh0IGFzIHRydXN0O1xuICB9XG5cbiAgZm9yRWFjaE5vZGUoY2FsbGJhY2s6IChub2RlOiBUKSA9PiB2b2lkKSB7XG4gICAgbGV0IG5vZGUgPSB0aGlzLl9oZWFkO1xuXG4gICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAgIGNhbGxiYWNrKG5vZGUgYXMgdHJ1c3QpO1xuICAgICAgbm9kZSA9IG5vZGUubmV4dCBhcyB0cnVzdDtcbiAgICB9XG4gIH1cblxuICBpbnNlcnRCZWZvcmUobm9kZTogVCwgcmVmZXJlbmNlOiBPcHRpb248VD4gPSBudWxsKTogVCB7XG4gICAgaWYgKHJlZmVyZW5jZSA9PT0gbnVsbCkgcmV0dXJuIHRoaXMuYXBwZW5kKG5vZGUpO1xuXG4gICAgaWYgKHJlZmVyZW5jZS5wcmV2KSByZWZlcmVuY2UucHJldi5uZXh0ID0gbm9kZTtcbiAgICBlbHNlIHRoaXMuX2hlYWQgPSBub2RlO1xuXG4gICAgbm9kZS5wcmV2ID0gcmVmZXJlbmNlLnByZXY7XG4gICAgbm9kZS5uZXh0ID0gcmVmZXJlbmNlO1xuICAgIHJlZmVyZW5jZS5wcmV2ID0gbm9kZTtcblxuICAgIHJldHVybiBub2RlO1xuICB9XG5cbiAgYXBwZW5kKG5vZGU6IFQpOiBUIHtcbiAgICBsZXQgdGFpbCA9IHRoaXMuX3RhaWw7XG5cbiAgICBpZiAodGFpbCkge1xuICAgICAgdGFpbC5uZXh0ID0gbm9kZTtcbiAgICAgIG5vZGUucHJldiA9IHRhaWw7XG4gICAgICBub2RlLm5leHQgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oZWFkID0gbm9kZTtcbiAgICB9XG5cbiAgICByZXR1cm4gKHRoaXMuX3RhaWwgPSBub2RlKTtcbiAgfVxuXG4gIHJlbW92ZShub2RlOiBUKTogVCB7XG4gICAgaWYgKG5vZGUucHJldikgbm9kZS5wcmV2Lm5leHQgPSBub2RlLm5leHQ7XG4gICAgZWxzZSB0aGlzLl9oZWFkID0gbm9kZS5uZXh0IGFzIHRydXN0O1xuXG4gICAgaWYgKG5vZGUubmV4dCkgbm9kZS5uZXh0LnByZXYgPSBub2RlLnByZXY7XG4gICAgZWxzZSB0aGlzLl90YWlsID0gbm9kZS5wcmV2IGFzIHRydXN0O1xuXG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICBbV0lMTF9EUk9QXSgpIHtcbiAgICB0aGlzLmZvckVhY2hOb2RlKGQgPT4gZGVzdHJ1Y3RvcihkKVtXSUxMX0RST1BdKCkpO1xuICB9XG5cbiAgW0RJRF9EUk9QXSgpIHtcbiAgICB0aGlzLmZvckVhY2hOb2RlKGQgPT4gZGVzdHJ1Y3RvcihkKVtESURfRFJPUF0oKSk7XG4gIH1cblxuICBnZXQgW0NISUxEUkVOXSgpOiBJdGVyYWJsZTxEcm9wPiB7XG4gICAgbGV0IG91dDogRHJvcFtdID0gW107XG4gICAgdGhpcy5mb3JFYWNoTm9kZShkID0+IG91dC5wdXNoKC4uLmRlc3RydWN0b3IoZClbQ0hJTERSRU5dKSk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNsaWNlPFQgZXh0ZW5kcyBMaW5rZWRMaXN0Tm9kZT4ge1xuICBoZWFkKCk6IE9wdGlvbjxUPjtcbiAgdGFpbCgpOiBPcHRpb248VD47XG4gIG5leHROb2RlKG5vZGU6IFQpOiBPcHRpb248VD47XG4gIGZvckVhY2hOb2RlKGNhbGxiYWNrOiAobm9kZTogVCkgPT4gdm9pZCk6IHZvaWQ7XG4gIHRvQXJyYXkoKTogVFtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENsb25lYWJsZUxpc3ROb2RlIGV4dGVuZHMgTGlua2VkTGlzdE5vZGUge1xuICBjbG9uZSgpOiB0aGlzO1xufVxuXG5leHBvcnQgY2xhc3MgTGlzdFNsaWNlPFQgZXh0ZW5kcyBMaW5rZWRMaXN0Tm9kZT4gaW1wbGVtZW50cyBTbGljZTxUPiB7XG4gIHByaXZhdGUgX2hlYWQ6IE9wdGlvbjxUPjtcbiAgcHJpdmF0ZSBfdGFpbDogT3B0aW9uPFQ+O1xuXG4gIGNvbnN0cnVjdG9yKGhlYWQ6IE9wdGlvbjxUPiwgdGFpbDogT3B0aW9uPFQ+KSB7XG4gICAgdGhpcy5faGVhZCA9IGhlYWQ7XG4gICAgdGhpcy5fdGFpbCA9IHRhaWw7XG4gIH1cblxuICBmb3JFYWNoTm9kZShjYWxsYmFjazogKG5vZGU6IFQpID0+IHZvaWQpIHtcbiAgICBsZXQgbm9kZSA9IHRoaXMuX2hlYWQ7XG5cbiAgICB3aGlsZSAobm9kZSAhPT0gbnVsbCkge1xuICAgICAgY2FsbGJhY2sobm9kZSk7XG4gICAgICBub2RlID0gdGhpcy5uZXh0Tm9kZShub2RlKTtcbiAgICB9XG4gIH1cblxuICBoZWFkKCk6IE9wdGlvbjxUPiB7XG4gICAgcmV0dXJuIHRoaXMuX2hlYWQ7XG4gIH1cblxuICB0YWlsKCk6IE9wdGlvbjxUPiB7XG4gICAgcmV0dXJuIHRoaXMuX3RhaWw7XG4gIH1cblxuICB0b0FycmF5KCk6IFRbXSB7XG4gICAgbGV0IG91dDogVFtdID0gW107XG4gICAgdGhpcy5mb3JFYWNoTm9kZShuID0+IG91dC5wdXNoKG4pKTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG5cbiAgbmV4dE5vZGUobm9kZTogVCk6IE9wdGlvbjxUPiB7XG4gICAgaWYgKG5vZGUgPT09IHRoaXMuX3RhaWwpIHJldHVybiBudWxsO1xuICAgIHJldHVybiBub2RlLm5leHQgYXMgVDtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgRU1QVFlfU0xJQ0UgPSBuZXcgTGlzdFNsaWNlKG51bGwsIG51bGwpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==