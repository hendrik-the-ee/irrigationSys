import { deprecate, assign } from '@glimmer/util';

function buildMustache(path, params, hash, raw, loc, strip) {
  if (typeof path === 'string') {
    path = buildHead(path);
  }

  return {
    type: 'MustacheStatement',
    path: path,
    params: params || [],
    hash: hash || buildHash([]),
    escaped: !raw,
    loc: buildLoc(loc || null),
    strip: strip || {
      open: false,
      close: false
    }
  };
}

function buildBlock(path, params, hash, _defaultBlock, _elseBlock, loc, openStrip, inverseStrip, closeStrip) {
  var defaultBlock;
  var elseBlock;

  if (_defaultBlock.type === 'Template') {
    if (false
    /* LOCAL_DEBUG */
    ) {
        false && !false && deprecate("b.program is deprecated. Use b.blockItself instead.");
      }

    defaultBlock = assign({}, _defaultBlock, {
      type: 'Block'
    });
  } else {
    defaultBlock = _defaultBlock;
  }

  if (_elseBlock !== undefined && _elseBlock !== null && _elseBlock.type === 'Template') {
    if (false
    /* LOCAL_DEBUG */
    ) {
        false && !false && deprecate("b.program is deprecated. Use b.blockItself instead.");
      }

    elseBlock = assign({}, _elseBlock, {
      type: 'Block'
    });
  } else {
    elseBlock = _elseBlock;
  }

  return {
    type: 'BlockStatement',
    path: buildHead(path),
    params: params || [],
    hash: hash || buildHash([]),
    program: defaultBlock || null,
    inverse: elseBlock || null,
    loc: buildLoc(loc || null),
    openStrip: openStrip || {
      open: false,
      close: false
    },
    inverseStrip: inverseStrip || {
      open: false,
      close: false
    },
    closeStrip: closeStrip || {
      open: false,
      close: false
    }
  };
}

function buildElementModifier(path, params, hash, loc) {
  return {
    type: 'ElementModifierStatement',
    path: buildHead(path),
    params: params || [],
    hash: hash || buildHash([]),
    loc: buildLoc(loc || null)
  };
}

function buildPartial(name, params, hash, indent, loc) {
  return {
    type: 'PartialStatement',
    name: name,
    params: params || [],
    hash: hash || buildHash([]),
    indent: indent || '',
    strip: {
      open: false,
      close: false
    },
    loc: buildLoc(loc || null)
  };
}

function buildComment(value, loc) {
  return {
    type: 'CommentStatement',
    value: value,
    loc: buildLoc(loc || null)
  };
}

function buildMustacheComment(value, loc) {
  return {
    type: 'MustacheCommentStatement',
    value: value,
    loc: buildLoc(loc || null)
  };
}

function buildConcat(parts, loc) {
  return {
    type: 'ConcatStatement',
    parts: parts || [],
    loc: buildLoc(loc || null)
  };
}

export function isLocSexp(value) {
  return Array.isArray(value) && value.length === 2 && value[0] === 'loc';
}
export function isParamsSexp(value) {
  return Array.isArray(value) && !isLocSexp(value);
}
export function isHashSexp(value) {
  if (typeof value === 'object' && value && !Array.isArray(value)) {
    expectType(value);
    return true;
  } else {
    return false;
  }
}

function expectType(_input) {
  return;
}

export function normalizeModifier(sexp) {
  if (typeof sexp === 'string') {
    return buildElementModifier(sexp);
  }

  var path = normalizeHead(sexp[0]);
  var params;
  var hash;
  var loc = null;
  var parts = sexp.slice(1);
  var next = parts.shift();

  _process: {
    if (isParamsSexp(next)) {
      params = next;
    } else {
      break _process;
    }

    next = parts.shift();

    if (isHashSexp(next)) {
      hash = normalizeHash(next);
    } else {
      break _process;
    }
  }

  if (isLocSexp(next)) {
    loc = next[1];
  }

  return {
    type: 'ElementModifierStatement',
    path: path,
    params: params || [],
    hash: hash || buildHash([]),
    loc: buildLoc(loc || null)
  };
}
export function normalizeAttr(sexp) {
  var name = sexp[0];
  var value;

  if (typeof sexp[1] === 'string') {
    value = buildText(sexp[1]);
  } else {
    value = sexp[1];
  }

  var loc = sexp[2] ? sexp[2][1] : undefined;
  return buildAttr(name, value, loc);
}
export function normalizeHash(hash, loc) {
  var pairs = [];
  Object.keys(hash).forEach(function (key) {
    pairs.push(buildPair(key, hash[key]));
  });
  return buildHash(pairs, loc);
}
export function normalizeHead(path) {
  if (typeof path === 'string') {
    return buildHead(path);
  } else {
    return buildHead(path[1], path[2] && path[2][1]);
  }
}
export function normalizeElementOptions() {
  var out = {};

  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  for (var _i = 0, _args = args; _i < _args.length; _i++) {
    var arg = _args[_i];

    switch (arg[0]) {
      case 'attrs':
        {
          var rest = arg.slice(1);
          out.attrs = rest.map(normalizeAttr);
          break;
        }

      case 'modifiers':
        {
          var _rest = arg.slice(1);

          out.modifiers = _rest.map(normalizeModifier);
          break;
        }

      case 'body':
        {
          var _rest2 = arg.slice(1);

          out.children = _rest2;
          break;
        }

      case 'comments':
        {
          var _rest3 = arg.slice(1);

          out.comments = _rest3;
          break;
        }

      case 'as':
        {
          var _rest4 = arg.slice(1);

          out.blockParams = _rest4;
          break;
        }

      case 'loc':
        {
          var _rest5 = arg[1];
          out.loc = _rest5;
          break;
        }
    }
  }

  return out;
}

function buildElement(tag, options) {
  var normalized;

  if (Array.isArray(options)) {
    for (var _len2 = arguments.length, rest = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {
      rest[_key2 - 2] = arguments[_key2];
    }

    normalized = normalizeElementOptions.apply(void 0, [options].concat(rest));
  } else {
    normalized = options || {};
  }

  var _normalized = normalized,
      attrs = _normalized.attrs,
      blockParams = _normalized.blockParams,
      modifiers = _normalized.modifiers,
      comments = _normalized.comments,
      children = _normalized.children,
      loc = _normalized.loc; // this is used for backwards compat, prior to `selfClosing` being part of the ElementNode AST

  var selfClosing = false;

  if (typeof tag === 'object') {
    selfClosing = tag.selfClosing;
    tag = tag.name;
  } else {
    if (tag.slice(-1) === '/') {
      tag = tag.slice(0, -1);
      selfClosing = true;
    }
  }

  return {
    type: 'ElementNode',
    tag: tag || '',
    selfClosing: selfClosing,
    attributes: attrs || [],
    blockParams: blockParams || [],
    modifiers: modifiers || [],
    comments: comments || [],
    children: children || [],
    loc: buildLoc(loc || null)
  };
}

function buildAttr(name, value, loc) {
  return {
    type: 'AttrNode',
    name: name,
    value: value,
    loc: buildLoc(loc || null)
  };
}

function buildText(chars, loc) {
  return {
    type: 'TextNode',
    chars: chars || '',
    loc: buildLoc(loc || null)
  };
} // Expressions


function buildSexpr(path, params, hash, loc) {
  return {
    type: 'SubExpression',
    path: buildHead(path),
    params: params || [],
    hash: hash || buildHash([]),
    loc: buildLoc(loc || null)
  };
}

function buildHead(original, loc) {
  if (typeof original !== 'string') return original;
  var parts = original.split('.');
  var thisHead = false;

  if (parts[0] === 'this') {
    thisHead = true;
    parts = parts.slice(1);
  }

  return {
    type: 'PathExpression',
    original: original,
    "this": thisHead,
    parts: parts,
    data: false,
    loc: buildLoc(loc || null)
  };
}

function buildLiteral(type, value, loc) {
  return {
    type: type,
    value: value,
    original: value,
    loc: buildLoc(loc || null)
  };
} // Miscellaneous


function buildHash(pairs, loc) {
  return {
    type: 'Hash',
    pairs: pairs || [],
    loc: buildLoc(loc || null)
  };
}

function buildPair(key, value, loc) {
  return {
    type: 'HashPair',
    key: key,
    value: value,
    loc: buildLoc(loc || null)
  };
}

function buildProgram(body, blockParams, loc) {
  return {
    type: 'Template',
    body: body || [],
    blockParams: blockParams || [],
    loc: buildLoc(loc || null)
  };
}

function buildBlockItself(body, blockParams, chained, loc) {
  if (chained === void 0) {
    chained = false;
  }

  return {
    type: 'Block',
    body: body || [],
    blockParams: blockParams || [],
    chained: chained,
    loc: buildLoc(loc || null)
  };
}

function buildTemplate(body, blockParams, loc) {
  return {
    type: 'Template',
    body: body || [],
    blockParams: blockParams || [],
    loc: buildLoc(loc || null)
  };
}

function buildSource(source) {
  return source || null;
}

function buildPosition(line, column) {
  return {
    line: line,
    column: column
  };
}

export var SYNTHETIC = {
  source: '(synthetic)',
  start: {
    line: 1,
    column: 0
  },
  end: {
    line: 1,
    column: 0
  }
};

function buildLoc() {
  for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
    args[_key3] = arguments[_key3];
  }

  if (args.length === 1) {
    var loc = args[0];

    if (loc && typeof loc === 'object') {
      return {
        source: buildSource(loc.source),
        start: buildPosition(loc.start.line, loc.start.column),
        end: buildPosition(loc.end.line, loc.end.column)
      };
    } else {
      return SYNTHETIC;
    }
  } else {
    var startLine = args[0],
        startColumn = args[1],
        endLine = args[2],
        endColumn = args[3],
        source = args[4];
    return {
      source: buildSource(source),
      start: buildPosition(startLine, startColumn),
      end: buildPosition(endLine, endColumn)
    };
  }
}

export default {
  mustache: buildMustache,
  block: buildBlock,
  partial: buildPartial,
  comment: buildComment,
  mustacheComment: buildMustacheComment,
  element: buildElement,
  elementModifier: buildElementModifier,
  attr: buildAttr,
  text: buildText,
  sexpr: buildSexpr,
  path: buildHead,
  concat: buildConcat,
  hash: buildHash,
  pair: buildPair,
  literal: buildLiteral,
  program: buildProgram,
  blockItself: buildBlockItself,
  template: buildTemplate,
  loc: buildLoc,
  pos: buildPosition,
  string: literal('StringLiteral'),
  "boolean": literal('BooleanLiteral'),
  number: literal('NumberLiteral'),
  undefined: function (_undefined) {
    function undefined() {
      return _undefined.apply(this, arguments);
    }

    undefined.toString = function () {
      return _undefined.toString();
    };

    return undefined;
  }(function () {
    return buildLiteral('UndefinedLiteral', undefined);
  }),
  "null": function _null() {
    return buildLiteral('NullLiteral', null);
  }
};

function literal(type) {
  return function (value) {
    return buildLiteral(type, value);
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3N5bnRheC9saWIvYnVpbGRlcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsU0FBQSxTQUFBLEVBQUEsTUFBQSxRQUFBLGVBQUE7O0FBU0EsU0FBQSxhQUFBLENBQUEsSUFBQSxFQUFBLE1BQUEsRUFBQSxJQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxLQUFBLEVBTXdCO0FBRXRCLE1BQUksT0FBQSxJQUFBLEtBQUosUUFBQSxFQUE4QjtBQUM1QixJQUFBLElBQUksR0FBRyxTQUFTLENBQWhCLElBQWdCLENBQWhCO0FBQ0Q7O0FBRUQsU0FBTztBQUNMLElBQUEsSUFBSSxFQURDLG1CQUFBO0FBRUwsSUFBQSxJQUZLLEVBRUwsSUFGSztBQUdMLElBQUEsTUFBTSxFQUFFLE1BQU0sSUFIVCxFQUFBO0FBSUwsSUFBQSxJQUFJLEVBQUUsSUFBSSxJQUFJLFNBQVMsQ0FKbEIsRUFJa0IsQ0FKbEI7QUFLTCxJQUFBLE9BQU8sRUFBRSxDQUxKLEdBQUE7QUFNTCxJQUFBLEdBQUcsRUFBRSxRQUFRLENBQUMsR0FBRyxJQU5aLElBTVEsQ0FOUjtBQU9MLElBQUEsS0FBSyxFQUFFLEtBQUssSUFBSTtBQUFFLE1BQUEsSUFBSSxFQUFOLEtBQUE7QUFBZSxNQUFBLEtBQUssRUFBRTtBQUF0QjtBQVBYLEdBQVA7QUFTRDs7QUFFRCxTQUFBLFVBQUEsQ0FBQSxJQUFBLEVBQUEsTUFBQSxFQUFBLElBQUEsRUFBQSxhQUFBLEVBQUEsVUFBQSxFQUFBLEdBQUEsRUFBQSxTQUFBLEVBQUEsWUFBQSxFQUFBLFVBQUEsRUFTNkI7QUFFM0IsTUFBQSxZQUFBO0FBQ0EsTUFBQSxTQUFBOztBQUVBLE1BQUksYUFBYSxDQUFiLElBQUEsS0FBSixVQUFBLEVBQXVDO0FBQ3JDLFFBQUE7QUFBQTtBQUFBLE1BQWlCO0FBQUEsaUJBQUEsQ0FBQSxLQUFBLElBQ2YsU0FEZSx1REFBQTtBQUVoQjs7QUFFRCxJQUFBLFlB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QTFCVyxHQUFBO0FBQUEsMkJBNEJUO0FBQ0YsV0FBTyxZQUFZLENBQUEsYUFBQSxFQUFuQixJQUFtQixDQUFuQjtBQUNEO0FBOUJZLENBQWY7O0FBbUNBLFNBQUEsT0FBQSxDQUFBLElBQUEsRUFBdUQ7QUFDckQsU0FBTyxVQUFBLEtBQUEsRUFBMEI7QUFDL0IsV0FBTyxZQUFZLENBQUEsSUFBQSxFQUFuQixLQUFtQixDQUFuQjtBQURGLEdBQUE7QUFHRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEFTVCBmcm9tICcuL3R5cGVzL25vZGVzJztcbmltcG9ydCB7IE9wdGlvbiwgRGljdCB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgZGVwcmVjYXRlLCBhc3NpZ24gfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7IExPQ0FMX0RFQlVHIH0gZnJvbSAnQGdsaW1tZXIvbG9jYWwtZGVidWctZmxhZ3MnO1xuaW1wb3J0IHsgU3RyaW5nTGl0ZXJhbCwgQm9vbGVhbkxpdGVyYWwsIE51bWJlckxpdGVyYWwgfSBmcm9tICcuL3R5cGVzL2hhbmRsZWJhcnMtYXN0JztcblxuLy8gU3RhdGVtZW50c1xuXG5leHBvcnQgdHlwZSBCdWlsZGVySGVhZCA9IHN0cmluZyB8IEFTVC5FeHByZXNzaW9uO1xuZXhwb3J0IHR5cGUgVGFnRGVzY3JpcHRvciA9IHN0cmluZyB8IHsgbmFtZTogc3RyaW5nOyBzZWxmQ2xvc2luZzogYm9vbGVhbiB9O1xuXG5mdW5jdGlvbiBidWlsZE11c3RhY2hlKFxuICBwYXRoOiBCdWlsZGVySGVhZCB8IEFTVC5MaXRlcmFsLFxuICBwYXJhbXM/OiBBU1QuRXhwcmVzc2lvbltdLFxuICBoYXNoPzogQVNULkhhc2gsXG4gIHJhdz86IGJvb2xlYW4sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvbixcbiAgc3RyaXA/OiBBU1QuU3RyaXBGbGFnc1xuKTogQVNULk11c3RhY2hlU3RhdGVtZW50IHtcbiAgaWYgKHR5cGVvZiBwYXRoID09PSAnc3RyaW5nJykge1xuICAgIHBhdGggPSBidWlsZEhlYWQocGF0aCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHR5cGU6ICdNdXN0YWNoZVN0YXRlbWVudCcsXG4gICAgcGF0aCxcbiAgICBwYXJhbXM6IHBhcmFtcyB8fCBbXSxcbiAgICBoYXNoOiBoYXNoIHx8IGJ1aWxkSGFzaChbXSksXG4gICAgZXNjYXBlZDogIXJhdyxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgICBzdHJpcDogc3RyaXAgfHwgeyBvcGVuOiBmYWxzZSwgY2xvc2U6IGZhbHNlIH0sXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkQmxvY2soXG4gIHBhdGg6IEJ1aWxkZXJIZWFkLFxuICBwYXJhbXM6IE9wdGlvbjxBU1QuRXhwcmVzc2lvbltdPixcbiAgaGFzaDogT3B0aW9uPEFTVC5IYXNoPixcbiAgX2RlZmF1bHRCbG9jazogQVNULlBvc3NpYmx5RGVwcmVjYXRlZEJsb2NrLFxuICBfZWxzZUJsb2NrPzogT3B0aW9uPEFTVC5Qb3NzaWJseURlcHJlY2F0ZWRCbG9jaz4sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvbixcbiAgb3BlblN0cmlwPzogQVNULlN0cmlwRmxhZ3MsXG4gIGludmVyc2VTdHJpcD86IEFTVC5TdHJpcEZsYWdzLFxuICBjbG9zZVN0cmlwPzogQVNULlN0cmlwRmxhZ3Ncbik6IEFTVC5CbG9ja1N0YXRlbWVudCB7XG4gIGxldCBkZWZhdWx0QmxvY2s6IEFTVC5CbG9jaztcbiAgbGV0IGVsc2VCbG9jazogT3B0aW9uPEFTVC5CbG9jaz4gfCB1bmRlZmluZWQ7XG5cbiAgaWYgKF9kZWZhdWx0QmxvY2sudHlwZSA9PT0gJ1RlbXBsYXRlJykge1xuICAgIGlmIChMT0NBTF9ERUJVRykge1xuICAgICAgZGVwcmVjYXRlKGBiLnByb2dyYW0gaXMgZGVwcmVjYXRlZC4gVXNlIGIuYmxvY2tJdHNlbGYgaW5zdGVhZC5gKTtcbiAgICB9XG5cbiAgICBkZWZhdWx0QmxvY2sgPSAoYXNzaWduKHt9LCBfZGVmYXVsdEJsb2NrLCB7IHR5cGU6ICdCbG9jaycgfSkgYXMgdW5rbm93bikgYXMgQVNULkJsb2NrO1xuICB9IGVsc2Uge1xuICAgIGRlZmF1bHRCbG9jayA9IF9kZWZhdWx0QmxvY2s7XG4gIH1cblxuICBpZiAoX2Vsc2VCbG9jayAhPT0gdW5kZWZpbmVkICYmIF9lbHNlQmxvY2sgIT09IG51bGwgJiYgX2Vsc2VCbG9jay50eXBlID09PSAnVGVtcGxhdGUnKSB7XG4gICAgaWYgKExPQ0FMX0RFQlVHKSB7XG4gICAgICBkZXByZWNhdGUoYGIucHJvZ3JhbSBpcyBkZXByZWNhdGVkLiBVc2UgYi5ibG9ja0l0c2VsZiBpbnN0ZWFkLmApO1xuICAgIH1cblxuICAgIGVsc2VCbG9jayA9IChhc3NpZ24oe30sIF9lbHNlQmxvY2ssIHsgdHlwZTogJ0Jsb2NrJyB9KSBhcyB1bmtub3duKSBhcyBBU1QuQmxvY2s7XG4gIH0gZWxzZSB7XG4gICAgZWxzZUJsb2NrID0gX2Vsc2VCbG9jaztcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0Jsb2NrU3RhdGVtZW50JyxcbiAgICBwYXRoOiBidWlsZEhlYWQocGF0aCksXG4gICAgcGFyYW1zOiBwYXJhbXMgfHwgW10sXG4gICAgaGFzaDogaGFzaCB8fCBidWlsZEhhc2goW10pLFxuICAgIHByb2dyYW06IGRlZmF1bHRCbG9jayB8fCBudWxsLFxuICAgIGludmVyc2U6IGVsc2VCbG9jayB8fCBudWxsLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICAgIG9wZW5TdHJpcDogb3BlblN0cmlwIHx8IHsgb3BlbjogZmFsc2UsIGNsb3NlOiBmYWxzZSB9LFxuICAgIGludmVyc2VTdHJpcDogaW52ZXJzZVN0cmlwIHx8IHsgb3BlbjogZmFsc2UsIGNsb3NlOiBmYWxzZSB9LFxuICAgIGNsb3NlU3RyaXA6IGNsb3NlU3RyaXAgfHwgeyBvcGVuOiBmYWxzZSwgY2xvc2U6IGZhbHNlIH0sXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkRWxlbWVudE1vZGlmaWVyKFxuICBwYXRoOiBCdWlsZGVySGVhZCxcbiAgcGFyYW1zPzogQVNULkV4cHJlc3Npb25bXSxcbiAgaGFzaD86IEFTVC5IYXNoLFxuICBsb2M/OiBPcHRpb248QVNULlNvdXJjZUxvY2F0aW9uPlxuKTogQVNULkVsZW1lbnRNb2RpZmllclN0YXRlbWVudCB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0VsZW1lbnRNb2RpZmllclN0YXRlbWVudCcsXG4gICAgcGF0aDogYnVpbGRIZWFkKHBhdGgpLFxuICAgIHBhcmFtczogcGFyYW1zIHx8IFtdLFxuICAgIGhhc2g6IGhhc2ggfHwgYnVpbGRIYXNoKFtdKSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRQYXJ0aWFsKFxuICBuYW1lOiBBU1QuUGF0aEV4cHJlc3Npb24sXG4gIHBhcmFtcz86IEFTVC5FeHByZXNzaW9uW10sXG4gIGhhc2g/OiBBU1QuSGFzaCxcbiAgaW5kZW50Pzogc3RyaW5nLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5QYXJ0aWFsU3RhdGVtZW50IHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnUGFydGlhbFN0YXRlbWVudCcsXG4gICAgbmFtZTogbmFtZSxcbiAgICBwYXJhbXM6IHBhcmFtcyB8fCBbXSxcbiAgICBoYXNoOiBoYXNoIHx8IGJ1aWxkSGFzaChbXSksXG4gICAgaW5kZW50OiBpbmRlbnQgfHwgJycsXG4gICAgc3RyaXA6IHsgb3BlbjogZmFsc2UsIGNsb3NlOiBmYWxzZSB9LFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZENvbW1lbnQodmFsdWU6IHN0cmluZywgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uKTogQVNULkNvbW1lbnRTdGF0ZW1lbnQge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdDb21tZW50U3RhdGVtZW50JyxcbiAgICB2YWx1ZTogdmFsdWUsXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkTXVzdGFjaGVDb21tZW50KFxuICB2YWx1ZTogc3RyaW5nLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5NdXN0YWNoZUNvbW1lbnRTdGF0ZW1lbnQge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdNdXN0YWNoZUNvbW1lbnRTdGF0ZW1lbnQnLFxuICAgIHZhbHVlOiB2YWx1ZSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRDb25jYXQoXG4gIHBhcnRzOiAoQVNULlRleHROb2RlIHwgQVNULk11c3RhY2hlU3RhdGVtZW50KVtdLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5Db25jYXRTdGF0ZW1lbnQge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdDb25jYXRTdGF0ZW1lbnQnLFxuICAgIHBhcnRzOiBwYXJ0cyB8fCBbXSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuLy8gTm9kZXNcblxuZXhwb3J0IHR5cGUgRWxlbWVudEFyZ3MgPVxuICB8IFsnYXR0cnMnLCAuLi5BdHRyU2V4cFtdXVxuICB8IFsnbW9kaWZpZXJzJywgLi4uTW9kaWZpZXJTZXhwW11dXG4gIHwgWydib2R5JywgLi4uQVNULlN0YXRlbWVudFtdXVxuICB8IFsnY29tbWVudHMnLCAuLi5FbGVtZW50Q29tbWVudFtdXVxuICB8IFsnYXMnLCAuLi5zdHJpbmdbXV1cbiAgfCBbJ2xvYycsIEFTVC5Tb3VyY2VMb2NhdGlvbl07XG5cbmV4cG9ydCB0eXBlIFBhdGhTZXhwID0gc3RyaW5nIHwgWydwYXRoJywgc3RyaW5nLCBMb2NTZXhwP107XG5cbmV4cG9ydCB0eXBlIE1vZGlmaWVyU2V4cCA9XG4gIHwgc3RyaW5nXG4gIHwgW1BhdGhTZXhwLCBMb2NTZXhwP11cbiAgfCBbUGF0aFNleHAsIEFTVC5FeHByZXNzaW9uW10sIExvY1NleHA/XVxuICB8IFtQYXRoU2V4cCwgQVNULkV4cHJlc3Npb25bXSwgRGljdDxBU1QuRXhwcmVzc2lvbj4sIExvY1NleHA/XTtcblxuZXhwb3J0IHR5cGUgQXR0clNleHAgPSBbc3RyaW5nLCBBU1QuQXR0ck5vZGVbJ3ZhbHVlJ10gfCBzdHJpbmcsIExvY1NleHA/XTtcblxuZXhwb3J0IHR5cGUgTG9jU2V4cCA9IFsnbG9jJywgQVNULlNvdXJjZUxvY2F0aW9uXTtcblxuZXhwb3J0IHR5cGUgRWxlbWVudENvbW1lbnQgPSBBU1QuTXVzdGFjaGVDb21tZW50U3RhdGVtZW50IHwgQVNULlNvdXJjZUxvY2F0aW9uIHwgc3RyaW5nO1xuXG5leHBvcnQgdHlwZSBTZXhwVmFsdWUgPVxuICB8IHN0cmluZ1xuICB8IEFTVC5FeHByZXNzaW9uW11cbiAgfCBEaWN0PEFTVC5FeHByZXNzaW9uPlxuICB8IExvY1NleHBcbiAgfCBQYXRoU2V4cFxuICB8IHVuZGVmaW5lZDtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzTG9jU2V4cCh2YWx1ZTogU2V4cFZhbHVlKTogdmFsdWUgaXMgTG9jU2V4cCB7XG4gIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKSAmJiB2YWx1ZS5sZW5ndGggPT09IDIgJiYgdmFsdWVbMF0gPT09ICdsb2MnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNQYXJhbXNTZXhwKHZhbHVlOiBTZXhwVmFsdWUpOiB2YWx1ZSBpcyBBU1QuRXhwcmVzc2lvbltdIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsdWUpICYmICFpc0xvY1NleHAodmFsdWUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNIYXNoU2V4cCh2YWx1ZTogU2V4cFZhbHVlKTogdmFsdWUgaXMgRGljdDxBU1QuRXhwcmVzc2lvbj4ge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICBleHBlY3RUeXBlPERpY3Q8QVNULkV4cHJlc3Npb24+Pih2YWx1ZSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGV4cGVjdFR5cGU8VD4oX2lucHV0OiBUKTogdm9pZCB7XG4gIHJldHVybjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZU1vZGlmaWVyKHNleHA6IE1vZGlmaWVyU2V4cCk6IEFTVC5FbGVtZW50TW9kaWZpZXJTdGF0ZW1lbnQge1xuICBpZiAodHlwZW9mIHNleHAgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGJ1aWxkRWxlbWVudE1vZGlmaWVyKHNleHApO1xuICB9XG5cbiAgbGV0IHBhdGg6IEFTVC5FeHByZXNzaW9uID0gbm9ybWFsaXplSGVhZChzZXhwWzBdKTtcbiAgbGV0IHBhcmFtczogQVNULkV4cHJlc3Npb25bXSB8IHVuZGVmaW5lZDtcbiAgbGV0IGhhc2g6IEFTVC5IYXNoIHwgdW5kZWZpbmVkO1xuICBsZXQgbG9jOiBBU1QuU291cmNlTG9jYXRpb24gfCBudWxsID0gbnVsbDtcblxuICBsZXQgcGFydHMgPSBzZXhwLnNsaWNlKDEpO1xuICBsZXQgbmV4dCA9IHBhcnRzLnNoaWZ0KCk7XG5cbiAgX3Byb2Nlc3M6IHtcbiAgICBpZiAoaXNQYXJhbXNTZXhwKG5leHQpKSB7XG4gICAgICBwYXJhbXMgPSBuZXh0IGFzIEFTVC5FeHByZXNzaW9uW107XG4gICAgfSBlbHNlIHtcbiAgICAgIGJyZWFrIF9wcm9jZXNzO1xuICAgIH1cblxuICAgIG5leHQgPSBwYXJ0cy5zaGlmdCgpO1xuXG4gICAgaWYgKGlzSGFzaFNleHAobmV4dCkpIHtcbiAgICAgIGhhc2ggPSBub3JtYWxpemVIYXNoKG5leHQgYXMgRGljdDxBU1QuRXhwcmVzc2lvbj4pO1xuICAgIH0gZWxzZSB7XG4gICAgICBicmVhayBfcHJvY2VzcztcbiAgICB9XG4gIH1cblxuICBpZiAoaXNMb2NTZXhwKG5leHQpKSB7XG4gICAgbG9jID0gbmV4dFsxXTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0VsZW1lbnRNb2RpZmllclN0YXRlbWVudCcsXG4gICAgcGF0aCxcbiAgICBwYXJhbXM6IHBhcmFtcyB8fCBbXSxcbiAgICBoYXNoOiBoYXNoIHx8IGJ1aWxkSGFzaChbXSksXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVBdHRyKHNleHA6IEF0dHJTZXhwKTogQVNULkF0dHJOb2RlIHtcbiAgbGV0IG5hbWUgPSBzZXhwWzBdO1xuICBsZXQgdmFsdWU7XG5cbiAgaWYgKHR5cGVvZiBzZXhwWzFdID09PSAnc3RyaW5nJykge1xuICAgIHZhbHVlID0gYnVpbGRUZXh0KHNleHBbMV0pO1xuICB9IGVsc2Uge1xuICAgIHZhbHVlID0gc2V4cFsxXTtcbiAgfVxuXG4gIGxldCBsb2MgPSBzZXhwWzJdID8gc2V4cFsyXVsxXSA6IHVuZGVmaW5lZDtcblxuICByZXR1cm4gYnVpbGRBdHRyKG5hbWUsIHZhbHVlLCBsb2MpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplSGFzaChoYXNoOiBEaWN0PEFTVC5FeHByZXNzaW9uPiwgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uKTogQVNULkhhc2gge1xuICBsZXQgcGFpcnM6IEFTVC5IYXNoUGFpcltdID0gW107XG5cbiAgT2JqZWN0LmtleXMoaGFzaCkuZm9yRWFjaChrZXkgPT4ge1xuICAgIHBhaXJzLnB1c2goYnVpbGRQYWlyKGtleSwgaGFzaFtrZXldKSk7XG4gIH0pO1xuXG4gIHJldHVybiBidWlsZEhhc2gocGFpcnMsIGxvYyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVIZWFkKHBhdGg6IFBhdGhTZXhwKTogQVNULkV4cHJlc3Npb24ge1xuICBpZiAodHlwZW9mIHBhdGggPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGJ1aWxkSGVhZChwYXRoKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYnVpbGRIZWFkKHBhdGhbMV0sIHBhdGhbMl0gJiYgcGF0aFsyXVsxXSk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZUVsZW1lbnRPcHRpb25zKC4uLmFyZ3M6IEVsZW1lbnRBcmdzW10pOiBCdWlsZEVsZW1lbnRPcHRpb25zIHtcbiAgbGV0IG91dDogQnVpbGRFbGVtZW50T3B0aW9ucyA9IHt9O1xuXG4gIGZvciAobGV0IGFyZyBvZiBhcmdzKSB7XG4gICAgc3dpdGNoIChhcmdbMF0pIHtcbiAgICAgIGNhc2UgJ2F0dHJzJzoge1xuICAgICAgICBsZXQgWywgLi4ucmVzdF0gPSBhcmc7XG4gICAgICAgIG91dC5hdHRycyA9IHJlc3QubWFwKG5vcm1hbGl6ZUF0dHIpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ21vZGlmaWVycyc6IHtcbiAgICAgICAgbGV0IFssIC4uLnJlc3RdID0gYXJnO1xuICAgICAgICBvdXQubW9kaWZpZXJzID0gcmVzdC5tYXAobm9ybWFsaXplTW9kaWZpZXIpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ2JvZHknOiB7XG4gICAgICAgIGxldCBbLCAuLi5yZXN0XSA9IGFyZztcbiAgICAgICAgb3V0LmNoaWxkcmVuID0gcmVzdDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdjb21tZW50cyc6IHtcbiAgICAgICAgbGV0IFssIC4uLnJlc3RdID0gYXJnO1xuXG4gICAgICAgIG91dC5jb21tZW50cyA9IHJlc3Q7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnYXMnOiB7XG4gICAgICAgIGxldCBbLCAuLi5yZXN0XSA9IGFyZztcbiAgICAgICAgb3V0LmJsb2NrUGFyYW1zID0gcmVzdDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdsb2MnOiB7XG4gICAgICAgIGxldCBbLCByZXN0XSA9IGFyZztcbiAgICAgICAgb3V0LmxvYyA9IHJlc3Q7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvdXQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQnVpbGRFbGVtZW50T3B0aW9ucyB7XG4gIGF0dHJzPzogQVNULkF0dHJOb2RlW107XG4gIG1vZGlmaWVycz86IEFTVC5FbGVtZW50TW9kaWZpZXJTdGF0ZW1lbnRbXTtcbiAgY2hpbGRyZW4/OiBBU1QuU3RhdGVtZW50W107XG4gIGNvbW1lbnRzPzogRWxlbWVudENvbW1lbnRbXTtcbiAgYmxvY2tQYXJhbXM/OiBzdHJpbmdbXTtcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uO1xufVxuXG5mdW5jdGlvbiBidWlsZEVsZW1lbnQodGFnOiBUYWdEZXNjcmlwdG9yLCBvcHRpb25zPzogQnVpbGRFbGVtZW50T3B0aW9ucyk6IEFTVC5FbGVtZW50Tm9kZTtcbmZ1bmN0aW9uIGJ1aWxkRWxlbWVudCh0YWc6IFRhZ0Rlc2NyaXB0b3IsIC4uLm9wdGlvbnM6IEVsZW1lbnRBcmdzW10pOiBBU1QuRWxlbWVudE5vZGU7XG5mdW5jdGlvbiBidWlsZEVsZW1lbnQoXG4gIHRhZzogVGFnRGVzY3JpcHRvcixcbiAgb3B0aW9ucz86IEJ1aWxkRWxlbWVudE9wdGlvbnMgfCBFbGVtZW50QXJncyxcbiAgLi4ucmVzdDogRWxlbWVudEFyZ3NbXVxuKTogQVNULkVsZW1lbnROb2RlIHtcbiAgbGV0IG5vcm1hbGl6ZWQ6IEJ1aWxkRWxlbWVudE9wdGlvbnM7XG4gIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbnMpKSB7XG4gICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZUVsZW1lbnRPcHRpb25zKG9wdGlvbnMsIC4uLnJlc3QpO1xuICB9IGVsc2Uge1xuICAgIG5vcm1hbGl6ZWQgPSBvcHRpb25zIHx8IHt9O1xuICB9XG5cbiAgbGV0IHsgYXR0cnMsIGJsb2NrUGFyYW1zLCBtb2RpZmllcnMsIGNvbW1lbnRzLCBjaGlsZHJlbiwgbG9jIH0gPSBub3JtYWxpemVkO1xuXG4gIC8vIHRoaXMgaXMgdXNlZCBmb3IgYmFja3dhcmRzIGNvbXBhdCwgcHJpb3IgdG8gYHNlbGZDbG9zaW5nYCBiZWluZyBwYXJ0IG9mIHRoZSBFbGVtZW50Tm9kZSBBU1RcbiAgbGV0IHNlbGZDbG9zaW5nID0gZmFsc2U7XG4gIGlmICh0eXBlb2YgdGFnID09PSAnb2JqZWN0Jykge1xuICAgIHNlbGZDbG9zaW5nID0gdGFnLnNlbGZDbG9zaW5nO1xuICAgIHRhZyA9IHRhZy5uYW1lO1xuICB9IGVsc2Uge1xuICAgIGlmICh0YWcuc2xpY2UoLTEpID09PSAnLycpIHtcbiAgICAgIHRhZyA9IHRhZy5zbGljZSgwLCAtMSk7XG4gICAgICBzZWxmQ2xvc2luZyA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnRWxlbWVudE5vZGUnLFxuICAgIHRhZzogdGFnIHx8ICcnLFxuICAgIHNlbGZDbG9zaW5nOiBzZWxmQ2xvc2luZyxcbiAgICBhdHRyaWJ1dGVzOiBhdHRycyB8fCBbXSxcbiAgICBibG9ja1BhcmFtczogYmxvY2tQYXJhbXMgfHwgW10sXG4gICAgbW9kaWZpZXJzOiBtb2RpZmllcnMgfHwgW10sXG4gICAgY29tbWVudHM6IChjb21tZW50cyBhcyBBU1QuTXVzdGFjaGVDb21tZW50U3RhdGVtZW50W10pIHx8IFtdLFxuICAgIGNoaWxkcmVuOiBjaGlsZHJlbiB8fCBbXSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRBdHRyKFxuICBuYW1lOiBzdHJpbmcsXG4gIHZhbHVlOiBBU1QuQXR0ck5vZGVbJ3ZhbHVlJ10sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULkF0dHJOb2RlIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnQXR0ck5vZGUnLFxuICAgIG5hbWU6IG5hbWUsXG4gICAgdmFsdWU6IHZhbHVlLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZFRleHQoY2hhcnM/OiBzdHJpbmcsIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvbik6IEFTVC5UZXh0Tm9kZSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ1RleHROb2RlJyxcbiAgICBjaGFyczogY2hhcnMgfHwgJycsXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbi8vIEV4cHJlc3Npb25zXG5cbmZ1bmN0aW9uIGJ1aWxkU2V4cHIoXG4gIHBhdGg6IEJ1aWxkZXJIZWFkLFxuICBwYXJhbXM/OiBBU1QuRXhwcmVzc2lvbltdLFxuICBoYXNoPzogQVNULkhhc2gsXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULlN1YkV4cHJlc3Npb24ge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdTdWJFeHByZXNzaW9uJyxcbiAgICBwYXRoOiBidWlsZEhlYWQocGF0aCksXG4gICAgcGFyYW1zOiBwYXJhbXMgfHwgW10sXG4gICAgaGFzaDogaGFzaCB8fCBidWlsZEhhc2goW10pLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZEhlYWQob3JpZ2luYWw6IEJ1aWxkZXJIZWFkLCBsb2M/OiBBU1QuU291cmNlTG9jYXRpb24pOiBBU1QuRXhwcmVzc2lvbiB7XG4gIGlmICh0eXBlb2Ygb3JpZ2luYWwgIT09ICdzdHJpbmcnKSByZXR1cm4gb3JpZ2luYWw7XG5cbiAgbGV0IHBhcnRzID0gb3JpZ2luYWwuc3BsaXQoJy4nKTtcbiAgbGV0IHRoaXNIZWFkID0gZmFsc2U7XG5cbiAgaWYgKHBhcnRzWzBdID09PSAndGhpcycpIHtcbiAgICB0aGlzSGVhZCA9IHRydWU7XG4gICAgcGFydHMgPSBwYXJ0cy5zbGljZSgxKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ1BhdGhFeHByZXNzaW9uJyxcbiAgICBvcmlnaW5hbCxcbiAgICB0aGlzOiB0aGlzSGVhZCxcbiAgICBwYXJ0cyxcbiAgICBkYXRhOiBmYWxzZSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRMaXRlcmFsPFQgZXh0ZW5kcyBBU1QuTGl0ZXJhbD4oXG4gIHR5cGU6IFRbJ3R5cGUnXSxcbiAgdmFsdWU6IFRbJ3ZhbHVlJ10sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogVCB7XG4gIHJldHVybiB7XG4gICAgdHlwZSxcbiAgICB2YWx1ZSxcbiAgICBvcmlnaW5hbDogdmFsdWUsXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH0gYXMgVDtcbn1cblxuLy8gTWlzY2VsbGFuZW91c1xuXG5mdW5jdGlvbiBidWlsZEhhc2gocGFpcnM/OiBBU1QuSGFzaFBhaXJbXSwgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uKTogQVNULkhhc2gge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdIYXNoJyxcbiAgICBwYWlyczogcGFpcnMgfHwgW10sXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkUGFpcihrZXk6IHN0cmluZywgdmFsdWU6IEFTVC5FeHByZXNzaW9uLCBsb2M/OiBBU1QuU291cmNlTG9jYXRpb24pOiBBU1QuSGFzaFBhaXIge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdIYXNoUGFpcicsXG4gICAga2V5OiBrZXksXG4gICAgdmFsdWUsXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkUHJvZ3JhbShcbiAgYm9keT86IEFTVC5TdGF0ZW1lbnRbXSxcbiAgYmxvY2tQYXJhbXM/OiBzdHJpbmdbXSxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuVGVtcGxhdGUge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdUZW1wbGF0ZScsXG4gICAgYm9keTogYm9keSB8fCBbXSxcbiAgICBibG9ja1BhcmFtczogYmxvY2tQYXJhbXMgfHwgW10sXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkQmxvY2tJdHNlbGYoXG4gIGJvZHk/OiBBU1QuU3RhdGVtZW50W10sXG4gIGJsb2NrUGFyYW1zPzogc3RyaW5nW10sXG4gIGNoYWluZWQgPSBmYWxzZSxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuQmxvY2sge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdCbG9jaycsXG4gICAgYm9keTogYm9keSB8fCBbXSxcbiAgICBibG9ja1BhcmFtczogYmxvY2tQYXJhbXMgfHwgW10sXG4gICAgY2hhaW5lZCxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRUZW1wbGF0ZShcbiAgYm9keT86IEFTVC5TdGF0ZW1lbnRbXSxcbiAgYmxvY2tQYXJhbXM/OiBzdHJpbmdbXSxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuVGVtcGxhdGUge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdUZW1wbGF0ZScsXG4gICAgYm9keTogYm9keSB8fCBbXSxcbiAgICBibG9ja1BhcmFtczogYmxvY2tQYXJhbXMgfHwgW10sXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkU291cmNlKHNvdXJjZT86IHN0cmluZykge1xuICByZXR1cm4gc291cmNlIHx8IG51bGw7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkUG9zaXRpb24obGluZTogbnVtYmVyLCBjb2x1bW46IG51bWJlcikge1xuICByZXR1cm4ge1xuICAgIGxpbmUsXG4gICAgY29sdW1uLFxuICB9O1xufVxuXG5leHBvcnQgY29uc3QgU1lOVEhFVElDOiBBU1QuU291cmNlTG9jYXRpb24gPSB7XG4gIHNvdXJjZTogJyhzeW50aGV0aWMpJyxcbiAgc3RhcnQ6IHsgbGluZTogMSwgY29sdW1uOiAwIH0sXG4gIGVuZDogeyBsaW5lOiAxLCBjb2x1bW46IDAgfSxcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkTG9jKGxvYzogT3B0aW9uPEFTVC5Tb3VyY2VMb2NhdGlvbj4pOiBBU1QuU291cmNlTG9jYXRpb247XG5mdW5jdGlvbiBidWlsZExvYyhcbiAgc3RhcnRMaW5lOiBudW1iZXIsXG4gIHN0YXJ0Q29sdW1uOiBudW1iZXIsXG4gIGVuZExpbmU/OiBudW1iZXIsXG4gIGVuZENvbHVtbj86IG51bWJlcixcbiAgc291cmNlPzogc3RyaW5nXG4pOiBBU1QuU291cmNlTG9jYXRpb247XG5cbmZ1bmN0aW9uIGJ1aWxkTG9jKC4uLmFyZ3M6IGFueVtdKTogQVNULlNvdXJjZUxvY2F0aW9uIHtcbiAgaWYgKGFyZ3MubGVuZ3RoID09PSAxKSB7XG4gICAgbGV0IGxvYyA9IGFyZ3NbMF07XG5cbiAgICBpZiAobG9jICYmIHR5cGVvZiBsb2MgPT09ICdvYmplY3QnKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzb3VyY2U6IGJ1aWxkU291cmNlKGxvYy5zb3VyY2UpLFxuICAgICAgICBzdGFydDogYnVpbGRQb3NpdGlvbihsb2Muc3RhcnQubGluZSwgbG9jLnN0YXJ0LmNvbHVtbiksXG4gICAgICAgIGVuZDogYnVpbGRQb3NpdGlvbihsb2MuZW5kLmxpbmUsIGxvYy5lbmQuY29sdW1uKSxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBTWU5USEVUSUM7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGxldCBbc3RhcnRMaW5lLCBzdGFydENvbHVtbiwgZW5kTGluZSwgZW5kQ29sdW1uLCBzb3VyY2VdID0gYXJncztcbiAgICByZXR1cm4ge1xuICAgICAgc291cmNlOiBidWlsZFNvdXJjZShzb3VyY2UpLFxuICAgICAgc3RhcnQ6IGJ1aWxkUG9zaXRpb24oc3RhcnRMaW5lLCBzdGFydENvbHVtbiksXG4gICAgICBlbmQ6IGJ1aWxkUG9zaXRpb24oZW5kTGluZSwgZW5kQ29sdW1uKSxcbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbXVzdGFjaGU6IGJ1aWxkTXVzdGFjaGUsXG4gIGJsb2NrOiBidWlsZEJsb2NrLFxuICBwYXJ0aWFsOiBidWlsZFBhcnRpYWwsXG4gIGNvbW1lbnQ6IGJ1aWxkQ29tbWVudCxcbiAgbXVzdGFjaGVDb21tZW50OiBidWlsZE11c3RhY2hlQ29tbWVudCxcbiAgZWxlbWVudDogYnVpbGRFbGVtZW50LFxuICBlbGVtZW50TW9kaWZpZXI6IGJ1aWxkRWxlbWVudE1vZGlmaWVyLFxuICBhdHRyOiBidWlsZEF0dHIsXG4gIHRleHQ6IGJ1aWxkVGV4dCxcbiAgc2V4cHI6IGJ1aWxkU2V4cHIsXG4gIHBhdGg6IGJ1aWxkSGVhZCxcbiAgY29uY2F0OiBidWlsZENvbmNhdCxcbiAgaGFzaDogYnVpbGRIYXNoLFxuICBwYWlyOiBidWlsZFBhaXIsXG4gIGxpdGVyYWw6IGJ1aWxkTGl0ZXJhbCxcbiAgcHJvZ3JhbTogYnVpbGRQcm9ncmFtLFxuICBibG9ja0l0c2VsZjogYnVpbGRCbG9ja0l0c2VsZixcbiAgdGVtcGxhdGU6IGJ1aWxkVGVtcGxhdGUsXG4gIGxvYzogYnVpbGRMb2MsXG4gIHBvczogYnVpbGRQb3NpdGlvbixcblxuICBzdHJpbmc6IGxpdGVyYWwoJ1N0cmluZ0xpdGVyYWwnKSBhcyAodmFsdWU6IHN0cmluZykgPT4gU3RyaW5nTGl0ZXJhbCxcbiAgYm9vbGVhbjogbGl0ZXJhbCgnQm9vbGVhbkxpdGVyYWwnKSBhcyAodmFsdWU6IGJvb2xlYW4pID0+IEJvb2xlYW5MaXRlcmFsLFxuICBudW1iZXI6IGxpdGVyYWwoJ051bWJlckxpdGVyYWwnKSBhcyAodmFsdWU6IG51bWJlcikgPT4gTnVtYmVyTGl0ZXJhbCxcbiAgdW5kZWZpbmVkKCkge1xuICAgIHJldHVybiBidWlsZExpdGVyYWwoJ1VuZGVmaW5lZExpdGVyYWwnLCB1bmRlZmluZWQpO1xuICB9LFxuICBudWxsKCkge1xuICAgIHJldHVybiBidWlsZExpdGVyYWwoJ051bGxMaXRlcmFsJywgbnVsbCk7XG4gIH0sXG59O1xuXG50eXBlIEJ1aWxkTGl0ZXJhbDxUIGV4dGVuZHMgQVNULkxpdGVyYWw+ID0gKHZhbHVlOiBUWyd2YWx1ZSddKSA9PiBUO1xuXG5mdW5jdGlvbiBsaXRlcmFsPFQgZXh0ZW5kcyBBU1QuTGl0ZXJhbD4odHlwZTogVFsndHlwZSddKTogQnVpbGRMaXRlcmFsPFQ+IHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlOiBUWyd2YWx1ZSddKTogVCB7XG4gICAgcmV0dXJuIGJ1aWxkTGl0ZXJhbCh0eXBlLCB2YWx1ZSk7XG4gIH07XG59XG4iXSwic291cmNlUm9vdCI6IiJ9